<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FF14 カンペ（マーカーのみ）</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,600..800&family=Inter:wght@400..800&family=Shippori+Mincho:wght@600..800&display=swap" rel="stylesheet">
<style>
    /* =========================================================
       EDIT HERE（後で調整しやすいCSS変数）
       ========================================================= */
    :root{
      /* kind pill label font */
      --kind-label-font: "Fraunces", "Shippori Mincho", "Noto Serif JP", "Noto Sans JP", system-ui, sans-serif;

      --bg0:#060810;
      --bg1:#0B1020;

      --card: rgba(18, 20, 32, 0.72);
      --card2: rgba(10, 12, 22, 0.70);
      --border: rgba(180, 205, 255, 0.18);
      --text: rgba(240, 248, 255, 0.92);
      --muted: rgba(240, 248, 255, 0.60);
      --shadow: 0 20px 54px rgba(0,0,0,0.60);

      --radius: 18px;
      --radius2: 14px;

      --btnBg: rgba(255,255,255,0.10);
      --btnBgHover: rgba(255,255,255,0.14);
      --btnBorder: rgba(180, 205, 255, 0.20);

      /* 枠サイズ（一定） */
      --marker-frame-h: clamp(160px, 18vw, 220px);

      /* マーカーボード */
      --board-size: clamp(260px, 36vw, 420px);
      --mk-size: clamp(45.8px, 6.51vw, 73.0px);

      /* タップしやすさ */
      --tap: 46px;

      /* kind pill icon size */
      --kind-icon: clamp(110px, 9.5vw, 140px);
      --kind-pill-minh: 190px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 20% 0%, rgba(110,165,255,0.20), transparent 60%),
        radial-gradient(900px 500px at 72% 8%, rgba(140,90,255,0.16), transparent 62%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
    }

    .app{ max-width: 1280px; margin: 0 auto; padding: 16px; }

    /* ===== Layout（左=ボード、右=表示） ===== */
    .layout{
      display:grid;
      grid-template-columns: 420px 1fr;
      gap: 16px;
      align-items:start;
    }
    @media (max-width: 1100px){
      .layout{ grid-template-columns: 380px 1fr; }
    }
    @media (max-width: 980px){
      /* iPad縦/スマホ：縦に積む */
      .layout{ grid-template-columns: 1fr; }
    }

    .panel{
      background: linear-gradient(180deg, var(--card), var(--card2));
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    /* left panel layout */
    aside.panel{ display:flex; flex-direction:column; }

    .board-wrap{ padding: 14px; }
    .board-caption{ color: var(--muted); font-size: 12px; margin-bottom: 10px; }

    /* ===== Marker board（t1風） ===== */
    .marker-board{
      width: var(--board-size);
      height: var(--board-size);
      max-width: 100%;
      border-radius: 22px;
      background:
        radial-gradient(900px 900px at 30% 20%, rgba(120,200,255,0.10), transparent 55%),
        radial-gradient(700px 700px at 70% 70%, rgba(170,120,255,0.10), transparent 58%),
        rgba(0,0,0,0.42);
      border: 1px solid rgba(180,205,255,0.18);
      box-shadow: 0 18px 50px rgba(0,0,0,0.62);
      position: relative;
      margin: 0 auto;
      overflow:hidden;
    }

    .mk{
      position:absolute;
      width: var(--mk-size);
      height: var(--mk-size);
      border: 3px solid rgba(0,0,0,0.70);
      box-shadow: 0 10px 22px rgba(0,0,0,0.55);
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      user-select:none;
      touch-action: manipulation;
      transform: translate(-50%,-50%);
      color: rgba(0,0,0,0.88);
      font-weight: 900;
      font-size: clamp(18px, 3.5vw, 30px);
      letter-spacing: 0.5px;
    }
    .mk.is-active{
      outline: 4px solid rgba(255,255,255,0.92);
      outline-offset: 4px;
      box-shadow: 0 0 0 10px rgba(255,255,255,0.15), 0 16px 28px rgba(0,0,0,0.58);
    }
    .mk.square{ border-radius: 11px; }
    .mk.circle{ border-radius: 999px; }

    /* colors */
    .c-pink{ background:#FF9FA7; }
    .c-yellow{ background:#FFF3A6; }
    .c-blue{ background:#93D7FF; }
    .c-purple{ background:#C7B3FF; }

    /* positions（必要ならここを微調整） */
    .mk-1{ left: 25%; top: 25%; }
    .mk-A{ left: 50%; top: 15%; }
    .mk-2{ left: 75%; top: 25%; }

    .mk-D{ left: 15%; top: 47%; }
    .mk-B{ left: 85%; top: 47%; }

    .mk-4{ left: 25%; top: 70%; }
    .mk-C{ left: 50%; top: 85%; }
    .mk-3{ left: 75%; top: 70%; }
    
    .state-line{ margin-top:10px; color:var(--muted); font-size:12px; text-align:center; }

    /* ===== Reset ===== */
    .reset-wrap{ margin-top:auto; padding: 14px; display:flex; flex-direction:column; gap:8px; }
    .btn{
      min-height: var(--tap);
      height: var(--tap);
      width: 100%;
      padding: 0 16px;
      border-radius: 14px;
      border: 1px solid var(--btnBorder);
      background: var(--btnBg);
      color: var(--text);
      cursor:pointer;
      font-weight: 780;
      letter-spacing: 0.3px;
      user-select:none;
      touch-action: manipulation;
      transition: background .12s ease, transform .08s ease, border-color .12s ease;
    }
    .btn:hover{ background: var(--btnBgHover); }
    .btn:active{ transform: scale(0.985); }

    .btn-reset{ background: rgba(255,90,120,0.14); border-color: rgba(255,140,160,0.35); }
    .btn-reset:hover{ background: rgba(255,90,120,0.18); }

    .reset-hint{ font-size:12px; color: var(--muted); text-align:center; }

    /* ===== Right display ===== */
    .stack{ display:flex; flex-direction:column; gap: 14px; }

    .section{
      background: linear-gradient(180deg, rgba(18,20,32,0.65), rgba(10,12,22,0.62));
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .section-header{
      display:flex;
      align-items:center;
      gap:10px;
      padding: 10px 12px;
      border-bottom: 1px solid rgba(255,255,255,0.08);
      user-select:none;
    }
    .section-title{ flex:1; font-weight: 820; font-size: 14px; letter-spacing: 0.2px; }
    .section-body{ padding: 12px; }

    .frame{
      position:relative;
      width:100%;
      border-radius: var(--radius2);
      border: 1px solid rgba(180,205,255,0.16);
      background: rgba(0,0,0,0.35);
      overflow:hidden;
    }

    .frame.placeholder::after{
      content: attr(data-placeholder);
      position:absolute;
      inset: 0;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 12px;
      text-align:center;
      color: rgba(240,248,255,0.52);
      font-weight: 760;
      letter-spacing: 0.2px;
      font-size: 12px;
    }

    .frame img{
      width:100%;
      height:100%;
      display:block;
      object-fit: contain;
      transform-origin:center;
    }

    /* Marker display rows（大円/頭割：左にカード、右に枠） */
    .marker-rows{ display:flex; flex-direction:column; gap: 12px; }

    .marker-row{
      display:grid;
      grid-template-columns: 170px 1fr;
      gap: 12px;
      align-items: stretch;
    }
    @media (max-width: 560px){
      .marker-row{ grid-template-columns: 1fr; }
    }

    .kind-pill{
      border-radius: 16px;
      border: 1px solid rgba(180,205,255,0.16);
      background: rgba(255,255,255,0.08);
      padding: 10px;
      min-height: var(--kind-pill-minh);
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:space-between;
      gap: 8px;
      cursor:pointer;
      user-select:none;
      touch-action: manipulation;
      transition: transform .08s ease, background .12s ease, border-color .12s ease;
    }
    .kind-pill:hover{ background: rgba(255,255,255,0.12); }
    .kind-pill:active{ transform: scale(0.985); }
    .kind-pill.is-on{ background: rgba(120,200,255,0.18); border-color: rgba(120,200,255,0.55); }

    .kind-pill .t{
      color: #fff;
      font-size: 24px;
      font-family: var(--kind-label-font);
      font-weight: 700;
      letter-spacing: 0.4px;
      text-shadow: 0 6px 16px rgba(0,0,0,0.55);
    }
    .kind-pill img{ width: var(--kind-icon); height: var(--kind-icon); max-width: 100%; max-height: 100%; object-fit: contain; filter: drop-shadow(0 10px 16px rgba(0,0,0,0.55)); }

    .marker-frame{ height: var(--marker-frame-h); }

    /* 非選択側を隠す（枠サイズ維持） */
    .marker-row.is-muted{ opacity: 0; pointer-events:none; user-select:none; transform: scale(0.99); }
    .marker-row{ transition: opacity .12s ease, transform .12s ease; }

    @media (prefers-reduced-motion: reduce){ *{ transition:none !important; } }
  </style>
</head>
<body>
  <div class="app">
    <div class="layout">
      <!-- LEFT -->
      <aside class="panel" aria-label="操作パネル">
        <div class="board-wrap">
          <div class="board-caption">マーカー（A/B/C/D/1/2/3/4）を押す → 右で大円/頭割を選択</div>
          <div class="marker-board" id="markerBoard">
            <button class="mk square c-pink mk-1" data-marker="1" type="button">1</button>
            <button class="mk circle c-pink mk-A" data-marker="A" type="button">A</button>
            <button class="mk square c-yellow mk-2" data-marker="2" type="button">2</button>

            <button class="mk circle c-purple mk-D" data-marker="D" type="button">D</button>
            <button class="mk circle c-yellow mk-B" data-marker="B" type="button">B</button>

            <button class="mk square c-purple mk-4" data-marker="4" type="button">4</button>
            <button class="mk circle c-blue mk-C" data-marker="C" type="button">C</button>
            <button class="mk square c-blue mk-3" data-marker="3" type="button">3</button>
          </div>
          <div class="state-line">状態: <span id="markerState">未選択</span></div>
        </div>

        <div class="reset-wrap">
          <button class="btn btn-reset" id="resetBtn" type="button">リセット</button>
          <div class="reset-hint">※マーカー選択状態のみリセット</div>
        </div>
      </aside>

      <!-- RIGHT -->
      <main class="stack" aria-label="表示パネル">
        <section class="section">
          <div class="section-header">
            <div class="section-title">マーカー表示（大円 / 頭割）</div>
          </div>
          <div class="section-body">
            <div class="marker-rows">
              <div class="marker-row" data-kind="aoe" id="rowAoe">
                <button class="kind-pill" data-pick-kind="aoe" type="button">
                  <div class="t">大円</div>
                  <img src="./img/effect_aoe.png" alt="大円" />
                </button>
                <div class="frame marker-frame placeholder" id="aoeFrame" data-placeholder="マーカーを押すとここに表示"></div>
              </div>

              <div class="marker-row" data-kind="share" id="rowShare">
                <button class="kind-pill" data-pick-kind="share" type="button">
                  <div class="t">頭割</div>
                  <img src="./img/effect_share.png" alt="頭割" />
                </button>
                <div class="frame marker-frame placeholder" id="shareFrame" data-placeholder="マーカーを押すとここに表示"></div>
              </div>
            </div>
          </div>
        </section>
      </main>
    </div>
  </div>

  <script>
    /* =========================================================
       EDIT HERE（画像パス）
       ========================================================= */
    const CONFIG = {
      // marker: ./img/sen_${id}_${kind}.png  (idは小文字 a/b/c/d, 数字はそのまま)
      marker: {
        base: './img/sen_',
        suffix: { aoe: '_aoe.png', share: '_share.png' }
      }
    };

    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));

    function setFrameImage(frameEl, src){
      const oldImg = frameEl.querySelector('img');
      if(oldImg) oldImg.remove();

      frameEl.classList.remove('placeholder');

      const img = new Image();
      img.alt = '';
      img.decoding = 'async';
      img.loading = 'eager';
      img.src = src;
      img.onerror = () => {
        frameEl.classList.add('placeholder');
        frameEl.dataset.placeholder = `画像が見つかりません: ${src}`;
        const bad = frameEl.querySelector('img');
        if(bad) bad.remove();
      };
      frameEl.appendChild(img);
    }

    function clearFrame(frameEl, placeholderText){
      frameEl.querySelectorAll('img').forEach(i => i.remove());
      frameEl.classList.add('placeholder');
      frameEl.dataset.placeholder = placeholderText;
    }

    /* =========================================================
       Marker logic
       - マーカー押下: 2種類表示に戻す
       - 大円/頭割を選ぶ: 片方だけ残す（もう片方は非表示）
       - 枠サイズは常に一定
       ========================================================= */
    let currentMarker = null; // 'A'.. or '1'..

    const markerState = $('#markerState');
    const aoeFrame = $('#aoeFrame');
    const shareFrame = $('#shareFrame');

    clearFrame(aoeFrame, 'マーカーを押すとここに表示');
    clearFrame(shareFrame, 'マーカーを押すとここに表示');

    function markerFileId(id){
      return /^[A-D]$/.test(id) ? id.toLowerCase() : id;
    }
    function getMarkerImage(id, kind){
      const fid = markerFileId(id);
      return CONFIG.marker.base + fid + CONFIG.marker.suffix[kind];
    }

    function setMarker(id){
      currentMarker = id;

      $$('.mk').forEach(b => b.classList.toggle('is-active', b.dataset.marker === id));
      markerState.textContent = `選択: ${id}`;

      // 2種類とも表示
      setFrameImage(aoeFrame, getMarkerImage(id, 'aoe'));
      setFrameImage(shareFrame, getMarkerImage(id, 'share'));

      $('#rowAoe').classList.remove('is-muted');
      $('#rowShare').classList.remove('is-muted');
      $$('.kind-pill').forEach(b => b.classList.remove('is-on'));
    }

    function pickKind(kind){
      if(!currentMarker) return;

      $('#rowAoe').classList.toggle('is-muted', kind !== 'aoe');
      $('#rowShare').classList.toggle('is-muted', kind !== 'share');
      $$('.kind-pill').forEach(b => b.classList.toggle('is-on', b.dataset.pickKind === kind));
    }

    $('#markerBoard').addEventListener('click', (e) => {
      const b = e.target.closest('.mk');
      if(!b) return;
      setMarker(b.dataset.marker);
    });

    document.addEventListener('click', (e) => {
      const pk = e.target.closest('[data-pick-kind]');
      if(pk){ pickKind(pk.dataset.pickKind); return; }

      const frame = e.target.closest('.frame');
      if(frame && (frame.id === 'aoeFrame' || frame.id === 'shareFrame')){
        pickKind(frame.id === 'aoeFrame' ? 'aoe' : 'share');
      }
    });

    /* =========================================================
       Reset button
       ========================================================= */
    const resetBtn = $('#resetBtn');
    function resetMarker(){
      currentMarker = null;
      markerState.textContent = '未選択';
      $$('.mk').forEach(b => b.classList.remove('is-active'));
      clearFrame(aoeFrame, 'マーカーを押すとここに表示');
      clearFrame(shareFrame, 'マーカーを押すとここに表示');
      $('#rowAoe').classList.remove('is-muted');
      $('#rowShare').classList.remove('is-muted');
      $$('.kind-pill').forEach(b => b.classList.remove('is-on'));
    }
    resetBtn.addEventListener('click', resetMarker);
  </script>
</body>
</html>
